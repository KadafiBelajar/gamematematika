<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Pilih Level - {{ stage_name|title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <!-- TAMBAHKAN BAGIAN INI -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- -------------------- -->
</head>
<body>
    <div class="container">
        <a href="{{ url_for('stage_select') }}" style="float: left;">Kembali ke Stage</a>
        
        <!-- Dev Menu for Testing -->
        <div style="float: right; font-size: 0.9em;">
            <button onclick="resetProgress()" style="padding: 5px 10px; cursor: pointer; background-color: #dc3545; color: white; border: none; border-radius: 4px;">
                ðŸ”„ Reset Progress
            </button>
        </div>
        
        <h1>Stage: {{ stage_name|title }}</h1>
        <p>Selesaikan level untuk membuka level berikutnya.</p>
        
        <div class="level-grid">
            {# Loop ini akan membuat 15 kotak level. Logika state (locked/unlocked) akan datang dari app.py #}
            {% for level in levels %}
                {% if level.state == 'locked' %}
                    <div class="level-box locked">
                        <span>{{ level.number }}</span>
                        <span class="lock-icon">ðŸ”’</span>
                    </div>
                {% else %}
                    <a href="{{ url_for('main_game', stage_name=stage_name, level_num=level.number) }}" class="level-box {{ level.state }}">
                        <span>{{ level.number }}</span>
                    </a>
                {% endif %}
            {% endfor %}
        </div>
    </div>
    
    <script>
        async function resetProgress() {
            if (confirm('Reset progress? Hanya level 1 yang akan terbuka.')) {
                const response = await fetch('/api/dev/reset-progress', { method: 'POST' });
                const result = await response.json();
                alert(result.message);
                location.reload();
            }
        }
    </script>
</body>
</html>
